#Лекции
# Определение уравнения в полных дифференциалах, необходимое и достаточное условие, построение общего решения

> [!info] <mark style="background: #BBFABBA6;">Определение</mark> - [[Уравнение в полных дифференциалах]]
[[Обыкновенное дифференциальное уравнение|Уравнение]] вида $$𝑀(𝑥, 𝑦)𝑑𝑥 + 𝑁(𝑥, 𝑦)𝑑𝑦 = 0$$ называется уравнением в полных дифференциалах, если его левая часть является полным дифференциалом некоторой непрерывно дифференцируемой функции $𝐹(𝑥, 𝑦)$.
>
> Для полного дифференциала функции имеет место равенство $$d𝐹 = \frac{{\partial𝐹}}{ \partial𝑥} 𝑑𝑥 + \frac{{\partial𝐹}}{{\partial𝑦}} 𝑑𝑦.$$

Если исходное уравнение в полных дифференциалах, то должно выполняться равенство $$𝑑𝐹 = 𝑀(𝑥, 𝑦)𝑑𝑥 + 𝑁(𝑥, 𝑦)𝑑y$$ Это возможно лишь при условии, что $$\frac{{\partial𝐹}}{{\partial𝑥}} = 𝑀(𝑥, 𝑦),\quad \frac{\partial𝐹}{\partial𝑦} = 𝑁(𝑥, 𝑦)$$Для того чтобы выполнялись эти равенства, необходимо и достаточно выполнение соотношения
$$\frac{\partial𝑀(𝑥, 𝑦)}{\partial𝑦} = \frac{\partial𝑁(𝑥, 𝑦)}{\partial𝑥} .$$
Если это тождество имеет место, то функцию $𝐹(𝑥, 𝑦)$ находим с помощью интегрирования. Именно, интегрируя равенство $$\frac{\partial𝐹} {\partial𝑥} (𝑥, 𝑦) = 𝑀(𝑥, 𝑦)$$по переменной $𝑥$ (предполагая при этом, что $𝑦$ — величина постоянная), определим функцию $𝐹(𝑥, 𝑦)$ с точностью до произвольного слагаемого, которое может зависеть от $𝑦$: $$𝐹(𝑥, 𝑦) = ∫︀ 𝑀(𝑥, 𝑦)𝑑𝑥+\varphi(𝑦) = Φ(𝑥, 𝑦)+\varphi(𝑦)$$Дифференцируя полученное равенство по переменной $𝑦$ и учитывая, что $𝐹_𝑦(𝑥, 𝑦) = 𝑁(𝑥, 𝑦)$, получаем для функции $\varphi(𝑦)$ следующее уравнение:

$$\varphi' (𝑦) = 𝑁(𝑥, 𝑦) − \frac{∂Φ(𝑥, 𝑦)}{∂𝑦} .$$
Правая часть здесь обязательно окажется функцией, зависящей только от $𝑦$. Интегрируя полученное уравнение по переменной $𝑦$, находим функцию $\varphi(𝑦)$. Подставляя результат в соотношение $$𝐹(𝑥, 𝑦) = Φ(𝑥, 𝑦) + \varphi(𝑦),$$находим в итоге и функцию $𝐹(𝑥, 𝑦)$. Общее решение уравнения в полных дифференциалах определяется теперь формулой $𝐹(𝑥, 𝑦) \ne 𝐶$. Это равенство задает неявно 𝑦 как функцию от $𝑥$.

> [!example]- *Пример.* Решить уравнение $$(3𝑥^{2} − 𝑦^{2} )𝑑𝑥 + (3𝑦^{2} − 2𝑥𝑦)𝑑𝑦 = 0.$$
> 
> *Решение*
> Для этого уравнения имеем $$𝑀(𝑥, 𝑦) = 3𝑥^2 − 𝑦^2 ;\quad \frac{{\partial𝑀}}{{\partial𝑦}} = −2𝑦;$$
> $$ 𝑁(𝑥, 𝑦) = 3𝑦^2 − 2𝑥𝑦;\quad \frac{\partial𝑁}{\partial𝑥} = −2𝑦.$$
> Таким образом, это уравнение в полных дифференциалах во всей плоскости.
> 
> Найдем соответствующую уравнению функцию $𝐹(𝑥, 𝑦)$, дифференциал которой совпадает с его левой частью. По условию должно быть
> $$\frac{\partial𝐹}{\partial𝑦} = 𝑁(𝑥, 𝑦) = 3𝑦^2 − 2𝑥y$$ 
> Интегрируя, получаем
> $$𝐹(𝑥, 𝑦) = \int_{0}^{y} (3\xi^2 − 2𝑥\xi)𝑑\xi + C(𝑥) = [\xi^3 − 𝑥\xi^{2} ]^{𝑦}_{0} + C(𝑥) = 𝑦^3 − 𝑥𝑦^{2} + C(𝑥)$$
> Кроме того должно выполняться равенство
> $$\partial𝐹/ \partial𝑥 = 𝑀(𝑥, 𝑦) = 3𝑥^2 − 𝑦^2$$
> Дифференцируя по $𝑥$ уже полученное для $𝐹(𝑥, 𝑦)$ представление, приходим к уравнению
> $$ −𝑦^2 + 𝐶' (𝑥) = 3𝑥^2 − 𝑦^2 ,\quad 𝐶' (𝑥) = 3𝑥^2$$
> Имеем далее $𝐶(𝑥) = 𝑥^3 + 𝐶_1$ и, следовательно,
> $$𝐹(𝑥, 𝑦) = 𝑦^3 −𝑥𝑦^2 + 𝑥^3$$ 
> Таким образом, общее решение исходного уравнения неявно задается равенством
> $$𝑦^3 − 𝑥𝑦^2 + 𝑥^3 = C$$
> Эта же формула называется полным интегралом рассматриваемого уравнения.


# Интегрирующий множитель: определение, примеры
## Зачем нужен интегрирующий множитель

Условие $$\frac{\partial𝑀(𝑥,𝑦)}{ \partial𝑦} = \frac{\partial𝑁(x,𝑦)} {\partial𝑥}$$выполняется не всегда. Поэтому не всякое дифференциальное уравнение $$𝑀(𝑥, 𝑦)𝑑𝑥 + 𝑁(𝑥, 𝑦)𝑑𝑦 = 0$$является уравнением в полных дифференциалах. 

Но оказывается, почти всегда существует такая функция $\mu(𝑥, 𝑦)$, что после умножения на эту функцию уравнение преобразуется в уравнение в полных дифференциалах. 

Другими словами, существует такая функция $𝜇(𝑥, 𝑦)$, что выполняется тождество$$  \frac{\partial}{\partial𝑦} (𝜇(𝑥, 𝑦)𝑀(𝑥, 𝑦)) = \frac{∂}{∂𝑥} (𝜇(𝑥, 𝑦)𝑁(𝑥, 𝑦)).$$
> [!info] <mark style="background: #BBFABBA6;">Определение</mark> - [[Интегрирующий множитель]]
> Функция $𝜇(𝑥, 𝑦)$, обладающая тем свойством, что $$\frac{∂}{∂𝑦} (𝜇(𝑥, 𝑦)𝑀(𝑥, 𝑦)) = \frac{∂}{∂𝑥}(𝜇(𝑥, 𝑦)𝑁(𝑥, 𝑦)),$$ называется **интегрирующим множителем** для исходного уравнения в [[Обыкновенное дифференциальное уравнение#Симметричная форма дифференциального уравнения|симметричной форме]].
> 


 > [!example]- *Пример.* Найти интегрирующий множитель для уравнения $$(2𝑥𝑦 − 𝑥^2 𝑦 − \frac{𝑦^{3}}{3} )𝑑𝑥 + (𝑥^2 + 𝑦^2 )𝑑𝑦 = 0.$$ 
 > 
 > *Решение.* Это уравнение в [[Обыкновенное дифференциальное уравнение#Симметричная форма дифференциального уравнения|симметричном виде]] с коэффициентами $$𝑀(𝑥, 𝑦) = 2𝑥𝑦 − 𝑥^2 𝑦 − \frac{𝑦^{3}}{3} ;\quad\frac{∂𝑀}{∂𝑦} = 2𝑥 − 𝑥^2 − 𝑦^2 ;$$ $$𝑁(𝑥, 𝑦) = 𝑥^2 + 𝑦^2 ; \quad\frac{∂𝑁}{∂𝑥} = 2𝑥.$$Это уравнение не является уравнением в [[Уравнение в полных дифференциалах|полных дифференциалах]]. Найдем соответствующий ему [[Интегрирующий множитель|интегрирующий множитель]] $𝜇(𝑥, 𝑦)$. 
 > 
 Выпишем уравнение для интегрирующего множителя: $$\frac{{∂(𝜇𝑀)}}{∂𝑦} = \frac{{∂(𝜇𝑁)}}{∂𝑥},$$или в развернутом виде:$$ \frac{∂𝜇}{∂𝑦}𝑀 +𝜇 \frac{∂𝑀}{∂𝑦} = \frac{∂𝜇}{∂𝑥}𝑁 +𝜇 \frac{∂𝑁}{∂𝑥}.$$Разделим уравнение на $𝜇$, затем перегруппируем слагаемые и приведем уравнение к виду $$𝑁 \frac{∂\ln{𝜇}}{∂𝑥} - 𝑀 \frac{∂\ln{𝜇}}{∂𝑦} = \frac{∂𝑀}{∂𝑦} − \frac{∂𝑁}{∂𝑥} .$$Подставляя сюда явные выражения коэффициентов $𝑀(𝑥, 𝑦)$ и $𝑁(𝑥, 𝑦)$, получаем $$(𝑥^2+𝑦^2) \frac{∂\ln{𝜇}}{∂𝑥} −(2𝑥𝑦−𝑥^2 𝑦− \frac{𝑦^{3}}{3} ) \frac{∂\ln{𝜇}}{∂𝑦} = −(𝑥^2+𝑦^2 ). $$Будем искать решения этого уравнения, которые зависят только от $𝑥$. В этом случае имеем равенство $$(𝑥^2+𝑦^2 ) \frac{∂\ln{𝜇}}{∂𝑥} = −(𝑥^2+𝑦^2 ), \quad\frac{∂\ln{𝜇}}{∂𝑥} = −1. $$Следовательно, $𝜇(𝑥) = 𝑒^{-𝑥}$. После умножения на $𝑒^{−𝑥}$ исходное уравнение, получаем уравнение в полных дифференциалах: $$𝑒^{−𝑥} (2𝑥𝑦−𝑥^2 𝑦− \frac{𝑦^{3}}{3})𝑑𝑥+𝑒^{−𝑥}(𝑥^2+𝑦^2)𝑑𝑦 = 0.$$Ищем соответствующий первый интеграл: $$\begin{align*}
𝐹(𝑥, 𝑦) = ∫︀ 𝑒^{−𝑥} (2𝑥𝑦 − 𝑥^2 𝑦 − \frac{𝑦^{3}}{3} )𝑑𝑥 + \varphi(𝑦)= \\= 𝑦 ∫︀ 𝑒^{−𝑥} (2𝑥 − 𝑥^ {2} )𝑑𝑥 − \frac{𝑦^{3}}{3} ∫︀ 𝑒^{−𝑥}𝑑𝑥 + \varphi(𝑦) =\\ 𝑦𝑥^{2} 𝑒^{−𝑥} + \frac{𝑦^{3}}{3} 𝑒^{−𝑥} + \varphi(𝑦). 
\end{align*}$$Дифференцируя полученное равенство по $𝑦$, получаем $$\frac{∂𝐹}{∂𝑦} = 𝑒^{−𝑥} (𝑥^2 + 𝑦^2) + \varphi' (𝑦) = 𝑒^{−𝑥} (𝑥^2 + 𝑦^2 ). $$Следовательно $\varphi' (𝑦) = 0$ и $\varphi(𝑦) = C$. Таким образом, общее решение исходного уравнения задается равенством $$𝑦𝑒^{−𝑥} (𝑥^2 + \frac{𝑦^{2}}{3} ) = 𝐶.$$ Здесь $𝐶$ — произвольная постоянная

# Интегрирующий множитель для линейных уравнений, примеры.
В общем случае нахождение интегрирующего множителя представляет собой весьма трудную задачу. Пример, когда ее удается решить, дают линейные уравнения.

Рассмотрим линейное уравнение первого порядка в нормальной форме$$ 𝑦'+𝑃(𝑥)𝑦 = 𝑄(𝑥). $$Умножим обе его части на функцию.
$$𝜇(𝑥) = 𝑒^{\int^𝑥_{𝑥_{0}} 𝑃(𝜉)𝑑𝜉} ,$$
а результат запишем в виде уравнения
$$\frac{𝑑}{𝑑𝑥}\Big(𝑦𝑒^{\int^𝑥_{𝑥_{0}} 𝑃(𝜉)𝑑𝜉} \Big) = 𝑄(𝑥)𝑒^{\int^{𝑥}_{𝑥_{0}}𝑃(𝜉)𝑑𝜉}.$$
Интегрируя обе его части, получаем
$$𝑦(𝑥)𝑒^{\int^{𝑥}_{𝑥_0}𝑃(𝜉)𝑑𝜉} = 𝐶 + \int 𝑄(𝑥)𝑒^{∫^𝑥_{𝑥_0} 𝑃(𝜉)𝑑𝜉 }𝑑𝑥.$$
# Интегрирующий множитель для однородных уравнений, сведение к уравнению с разделяющимися переменными, примеры

Для уравнений вида $$𝑀(𝑥, 𝑦)𝑑𝑥 + 𝑁(𝑥, 𝑦)𝑑𝑦 = 0, $$где $𝑀(𝑥, 𝑦)$ и $𝑁(𝑥, 𝑦)$ — функции одинаковой степени [[Однородная функция|однородности]], интегрирующий множитель можно найти в виде отношения $$𝜇(𝑥, 𝑦) = \frac{1}{𝑥𝑀(𝑥,𝑦)+𝑦𝑁(𝑥,𝑦)}$$при условии, что знаменатель дроби не обращается в ноль.

Исходное уравнение, умноженное на интегрирующий множитель, принимает вид $$\frac{𝑀(𝑥,𝑦)𝑑𝑥}{𝑥𝑀(𝑥,𝑦)+𝑦𝑁(𝑥,𝑦)}+ \frac{𝑁(𝑥,𝑦)𝑑𝑦} {𝑥𝑀(𝑥,𝑦)+𝑦𝑁(𝑥,𝑦)} = 0. $$Преобразуем это уравнение в [[Уравнения с разделяющимися переменными|уравнение с разделяющимися переменными]], пользуясь условием, что функции $𝑀(𝑥, 𝑦)$ и $𝑁(𝑥, 𝑦)$ одинаковой степени [[Однородная функция|однородности]] $𝛼$. 

Сделаем замену $𝑦 = 𝑡𝑥$. Тогда получим $$𝑀(𝑥, 𝑦) = 𝑥^𝛼𝑃(𝑡);\quad𝑁(𝑥, 𝑦) = 𝑥^𝛼𝑄(𝑡), $$$$𝑑𝑦 = 𝑡𝑑𝑥 + 𝑥𝑑𝑡.$$ Подставляя в уравнение, получаем $$\frac{𝑥^ 𝛼(𝑃(𝑡)𝑑𝑥+𝑡𝑄(𝑡)𝑑𝑥+𝑄(𝑡)𝑥𝑑𝑡)} {𝑥^{𝛼}(𝑃(𝑡)𝑥+𝑄(𝑡)𝑡𝑥)} = 0, $$$$\frac{(𝑃(𝑡)+𝑄(𝑡)𝑡)𝑑𝑥} {(𝑃(𝑡)+𝑄(𝑡)𝑡)𝑥} +\frac{ 𝑥𝑄(𝑡)𝑑𝑡} {𝑥(𝑄(𝑡)+𝑃(𝑡))} = 0.$$
Произведя сокращения одинаковых множителей в числителе и знаменателе, получаем уравнение $$\frac{𝑑𝑥}{𝑥} + \frac{𝑄(𝑡)𝑑𝑡} {𝑄(𝑡)+𝑃(𝑡)} = 0. $$Это уравнение в полных дифференциалах: левая часть — это полный дифференциал функции $𝐹(𝑥, 𝑡)$, такой что $$\frac{∂𝐹}{∂𝑥} = \frac{1}{𝑥} , \frac{∂𝐹}{∂𝑡} = \frac{𝑄(𝑡)}{𝑄(𝑡)𝑡+𝑃(𝑡)} .$$ Следовательно, $𝐹_{𝑥𝑡} = 𝐹_{𝑡𝑥} = 0$, а значит имеем $𝑑𝐹(𝑥, 𝑦) = 0$. Нетрудно видеть, что $$𝐹(𝑥, 𝑡) = \ln |𝑥| + 𝑔(𝑡), $$где $$𝑔(𝑡) = ∫︀ \frac {𝑄(𝑡)} {𝑄(𝑡)𝑡+𝑃(𝑡)} 𝑑𝑡.$$
> [!error] Добавить пример

# Достаточный признак существования интегрирующего множителя для уравнений в симметричной форме

Пусть для функции $𝑤(𝑥, 𝑦)$ выполняется тождество $$\frac{\frac{∂𝑀}{∂𝑦} (𝑥, 𝑦) − \frac{∂𝑁}{∂𝑥} (𝑥, 𝑦)} {𝑁(𝑥, 𝑦) \frac{∂𝑤}{∂𝑥} (𝑥, 𝑦) − 𝑀(𝑥, 𝑦) \frac{∂𝑤}{∂𝑦} (𝑥, 𝑦)} = 𝜓(𝑤(𝑥, 𝑦).$$Тогда интегрирующий множитель для уравнения в симметричной форме можно найти по формуле $$𝜇(𝑥, 𝑦) = 𝑒^{∫︀ 𝜓(𝑡)𝑑𝑡} |_{𝑡 = 𝑤(𝑥, 𝑦)} .
$$
Рассмотрим несколько частных случаев:

1) Если функция $$\frac{\frac{∂𝑀(𝑥,𝑦)}{∂𝑦} − \frac{∂𝑁(𝑥,𝑦)} {∂𝑥} }{𝑁(𝑥,𝑦)} $$есть функция $𝜓(𝑥)$, то есть зависит только от $𝑥$, тогда и интегрирующий множитель зависит только от $x$:$$𝜇(𝑥) = 𝑒^{∫︀ 𝜓(𝑥)𝑑𝑥};$$ 
2) Если функция $$\frac{\frac{∂𝑀(𝑥,𝑦)} {∂𝑦} − \frac{∂𝑁(𝑥,𝑦)} {∂𝑥} }{−𝑀(𝑥,𝑦)}$$есть функция $𝜓(𝑦)$, то есть зависит только от $𝑦$, тогда и интегрирующий множитель зависит только от $𝑦$: $𝜇(𝑦) = 𝑒^{∫︀ 𝜓(𝑦)𝑑𝑦}$; 
3) Если функция $$\frac{\frac{∂𝑀(𝑥,𝑦)}{ ∂𝑦} − \frac{∂𝑁(𝑥,𝑦)} {∂𝑥}} {𝑦𝑁(𝑥,𝑦)−𝑥𝑀(𝑥,𝑦)}$$ зависит только от произведения $𝑥𝑦$, то и интегрирующий множитель зависит только от этого произведения. Этот множитель имеет вид $$𝜇(𝑥𝑦) = 𝑒^{∫︀ 𝜓(𝑡)𝑑𝑡} |_{𝑡 = 𝑥 · 𝑦} ; $$
4) Если функция$$ \frac{\frac{∂𝑀(𝑥,𝑦)}{∂𝑦} − \frac{∂𝑁(𝑥,𝑦)} {∂𝑥} }{𝑁(𝑥,𝑦)−𝑀(𝑥,𝑦)}$$ зависит только от суммы $𝑥 + 𝑦$, то и интегрирующий множитель зависит только от суммы. Этот множитель имеет вид$$ 𝜇(𝑥 + 𝑦) = 𝑒^{∫︀ 𝜓(𝑡)𝑑𝑡}|_{𝑡 = 𝑥 + 𝑦}.$$
При умножении уравнения на интегрирующий множитель область определения его коэффициентов может уменьшится. 

Для того чтобы при этом не потерять решения, необходимо непосредственно на исходном уравнении проверить, являются ли его решениями функции, порождаемые исключенными из рассмотрения точками.